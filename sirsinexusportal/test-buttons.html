<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPal Button Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        .container { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
        input, select { padding: 10px; margin: 10px 0; width: 100%; box-sizing: border-box; }
        #paypal-button-container { margin-top: 20px; }
        .message { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <h1>PayPal Button Test Page</h1>
    <p>This page tests the PayPal integration with the corrected SDK parameters.</p>
    
    <div class="container">
        <h3>Payment Details</h3>
        <label>Amount (USD):</label>
        <input type="number" id="amount" min="1" max="10000" step="0.01" value="5.00" onchange="updateButtons()">
        
        <label>Description:</label>
        <input type="text" id="description" value="Test Payment" onchange="updateButtons()">
        
        <div id="status" class="message info">
            SDK Loading Status: <span id="sdk-status">Loading...</span>
        </div>
    </div>
    
    <div class="container">
        <h3>PayPal Buttons</h3>
        <div id="paypal-button-container"></div>
        <div id="button-message"></div>
    </div>
    
    <div class="container">
        <h3>Debug Information</h3>
        <div id="debug-info"></div>
    </div>

    <!-- PayPal SDK with corrected parameters -->
    <script src="https://www.paypal.com/sdk/js?client-id=ASUI7q4yAs6anh26J6T_7hLyX0UwUbVWQS-8lgngn9z0W6VX4zrt2y7Q_auiXBAUrzxd1ibBrz22KDAr&currency=USD&components=buttons,marks,funding-eligibility&enable-funding=venmo,paylater,card&disable-funding=credit"></script>

    <script>
        let buttonsRendered = false;
        
        // Check SDK loading status
        function checkSDKStatus() {
            const statusEl = document.getElementById('sdk-status');
            const debugEl = document.getElementById('debug-info');
            
            if (typeof paypal !== 'undefined') {
                statusEl.textContent = 'PayPal SDK Loaded Successfully ✓';
                statusEl.parentElement.className = 'message success';
                
                debugEl.innerHTML = `
                    <strong>SDK Details:</strong><br>
                    - PayPal object: ${typeof paypal}<br>
                    - PayPal.Buttons: ${typeof paypal.Buttons}<br>
                    - Version: ${paypal.version || 'Unknown'}<br>
                    - Ready to render buttons
                `;
                
                // Initial button render
                updateButtons();
            } else {
                statusEl.textContent = 'PayPal SDK Failed to Load ✗';
                statusEl.parentElement.className = 'message error';
                
                debugEl.innerHTML = `
                    <strong>SDK Error:</strong><br>
                    - PayPal object is undefined<br>
                    - Check console for network errors<br>
                    - Verify client ID is valid
                `;
            }
        }
        
        function updateButtons() {
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const description = document.getElementById('description').value || 'Test Payment';
            const container = document.getElementById('paypal-button-container');
            const messageEl = document.getElementById('button-message');
            
            // Clear previous buttons
            container.innerHTML = '';
            messageEl.innerHTML = '';
            
            if (amount < 1) {
                messageEl.innerHTML = '<div class="message info">Enter an amount ≥ $1.00 to see payment buttons</div>';
                return;
            }
            
            if (typeof paypal === 'undefined') {
                messageEl.innerHTML = '<div class="message error">PayPal SDK not loaded</div>';
                return;
            }
            
            if (typeof paypal.Buttons !== 'function') {
                messageEl.innerHTML = '<div class="message error">PayPal Buttons not available</div>';
                return;
            }
            
            try {
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        console.log('Creating order for:', amount, description);
                        return actions.order.create({
                            purchase_units: [{
                                amount: {
                                    value: amount.toFixed(2),
                                    currency_code: 'USD'
                                },
                                description: description
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            console.log('Payment successful:', details);
                            messageEl.innerHTML = `<div class="message success">Payment successful! Transaction ID: ${details.id}</div>`;
                        });
                    },
                    onError: function(err) {
                        console.error('PayPal error:', err);
                        messageEl.innerHTML = '<div class="message error">Payment failed. Check console for details.</div>';
                    },
                    onCancel: function(data) {
                        console.log('Payment cancelled:', data);
                        messageEl.innerHTML = '<div class="message info">Payment was cancelled by user.</div>';
                    },
                    style: {
                        layout: 'vertical',
                        color: 'blue',
                        shape: 'pill',
                        label: 'paypal'
                    }
                }).render('#paypal-button-container').then(function() {
                    console.log('PayPal buttons rendered successfully');
                    buttonsRendered = true;
                    messageEl.innerHTML = '<div class="message success">PayPal buttons loaded and ready!</div>';
                }).catch(function(err) {
                    console.error('Render error:', err);
                    messageEl.innerHTML = '<div class="message error">Failed to render PayPal buttons. Check console.</div>';
                });
            } catch (error) {
                console.error('PayPal initialization error:', error);
                messageEl.innerHTML = '<div class="message error">PayPal initialization failed. Check console.</div>';
            }
        }
        
        // Wait for SDK to load
        window.addEventListener('load', function() {
            setTimeout(checkSDKStatus, 1000); // 1 second delay like in main page
        });
        
        // Also check on DOM ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkSDKStatus, 1000);
        });
    </script>
</body>
</html>
